(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-223e"],{"EM+P":function(e,t,r){"use strict";var a=r("d0pQ");r.n(a).a},d0pQ:function(e,t,r){},fr7Y:function(e,t,r){"use strict";r.r(t);var a=r("EJiy"),n=r.n(a),o=r("uBC2"),s=(r("N9E5"),r("t3Un")),i=r("EVdn"),l=r.n(i),c={data:function(){return{dialogVisible:!1,isEdit:!1,flag:0,draftsList:[],currentDraftProject:{projectName:"hhhh",projectId:"fff",projectStart:new Date,projectContractUrl:"哈哈哈哈哈哈哈哈哈哈",adminAreaId:"llll",adminRentId:"22",adminAreaName:"吴亦凡"},newProgram:{name:"",id:"",AreaManager:"",rentManager:"",date:"",desc:"",rentId:"",companyName:""},rules:{name:[{required:!0,message:"请输入活项目名称",trigger:"blur"}],id:[{required:!0,message:"请输入项目ID",trigger:"blur"}],date:[{required:!0,message:"必须选择创建时间",trigger:"blur"}]},areaManagerArr:[],rentManagerArr:[]}},mounted:function(){var e=this;l.a.ajax({type:"GET",url:s.a.BASEURL+"/projectInfo",xhrFields:{withCredentials:!0},contentType:"application/json",headers:{Authorization:localStorage.getItem("token")},data:"userFlag="+this.flag,success:function(t){console.log(t,"草稿中的项目"),t.projectList&&(e.draftsList=t.projectList,e.dialogVisible=!0)},error:function(e){console.log(e.status)}})},beforeRouteLeave:function(e,t,r){t.meta.keepAlive=!1,r()},methods:{handleClose:function(e){var t=this;this.$confirm("确认关闭？").then(function(r){e(),t.newProgram.id=(new Date).getTime()}).catch(function(e){})},onSubmit:function(){var e=this.newProgram.AreaManager.split(" ");console.log(e,"我选择的区域管理员数组");var t=e[0],r=this.newProgram.rentManager.split(" ");console.log(r,"我选择的租方管理员数组");var a=r[0];if(""!==this.newProgram.name&&""!==this.newProgram.id)if(this.newProgram.date){console.log(this.newProgram.date,"date",n()(this.newProgram.date)),"string"==typeof this.newProgram.date&&(this.newProgram.date=this.stringToDate(this.newProgram.date));var o={projectId:this.newProgram.id,projectName:this.newProgram.name,adminAreaId:t,projectStart:this.newProgram.date.getTime(),adminRentId:a,companyName:this.newProgram.companyName};this.$router.push({path:"/program_management/create_program/contract",query:{project:o,currentEditContract:this.currentDraftProject.contract}})}else this.$message({type:"warning",message:"请选择项目创建时间！"});else this.$message({type:"warning",message:"必须填写项目名称和项目号！"})},onCancel:function(){this.$message({message:"cancel!",type:"warning"})},getRentManagerList:function(){var e=this;l.a.ajax({type:"GET",url:s.a.BASEURL+"/getRentList",headers:{Authorization:localStorage.getItem("token")},xhrFields:{withCredentials:!0},success:function(t){!1===t.isLogin&&(e.$message({message:"您的登录已失效，请重新登录！",type:"warning"}),e.$router.push({path:"/login"}));var r=t.resultList;console.log(r),e.rentManagerArr=r},error:function(e){console.log(e.status)}})},getAreaManagerList:function(){var e=this;Object(o.a)("userId");l.a.ajax({type:"GET",url:s.a.BASEURL+"/getAreaList",headers:{Authorization:localStorage.getItem("token")},xhrFields:{withCredentials:!0},success:function(t){!1===t.isLogin&&(e.$message({message:"您的登录已失效，请重新登录！",type:"warning"}),e.$router.push({path:"/login"}));var r=t.resultList;console.log(r),e.areaManagerArr=r},error:function(e){console.log(e.status)}})},editDraft:function(e){var t=this;console.log(e),this.dialogVisible=!1,e?(this.isEdit=!0,l.a.ajax({type:"GET",url:s.a.BASEURL+"/getCurrentEditProject",xhrFields:{withCredentials:!0},headers:{Authorization:localStorage.getItem("token")},data:"projectId="+e,success:function(e){console.log("getCurrentEditProject",e),!0===e.isRead?e.projectDetail&&(t.currentDraftProject=e.projectDetail,t.currentDraftProject.contract=e.resultString,t.newProgram.name=t.currentDraftProject.projectName,t.newProgram.id=t.currentDraftProject.projectId,t.newProgram.rentManager=t.currentDraftProject.adminRentId+" "+t.currentDraftProject.adminRentUser.userName,t.newProgram.date=t.currentDraftProject.projectStart,t.newProgram.companyName=t.currentDraftProject.companyName):t.$message({type:"warning",message:"读取失败！"}),!1===e.isAllowed&&t.$message({type:"warning",message:"您没有权限！"})},error:function(e){console.log(e.status)}})):this.newProgram.id=(new Date).getTime()},stringToDate:function(e){if(e)return new Date(e.replace(/-/g,"/"))}}},m=(r("EM+P"),r("KHd+")),g=Object(m.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-dialog",{attrs:{title:"修改/新建项目信息",visible:e.dialogVisible,width:"722px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-row",{staticStyle:{"margin-top":"20px"}},[r("el-card",{staticClass:"box-card elCard",attrs:{shadow:"hover"}},[r("span",{staticClass:"cardContent"},[e._v("新建空白项目")]),e._v(" "),r("el-button",{staticClass:"cardBtn",attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(t){e.editDraft()}}})],1)],1),e._v(" "),e._l(e.draftsList,function(t){return r("el-row",{staticStyle:{"margin-top":"20px"}},[r("el-card",{staticClass:"box-card elCard",attrs:{shadow:"hover"}},[r("span",{staticClass:"cardContent"},[e._v(e._s(t.projectName)+"("+e._s(t.projectId)+")")]),e._v(" "),r("el-button",{staticClass:"cardBtn",attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(r){e.editDraft(t.projectId)}}})],1)],1)})],2),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.newProgram,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入新项目名称"},model:{value:e.newProgram.name,callback:function(t){e.$set(e.newProgram,"name",t)},expression:"newProgram.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目号",prop:"id"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.newProgram.id,callback:function(t){e.$set(e.newProgram,"id",t)},expression:"newProgram.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"租方管理员"}},[r("el-select",{attrs:{placeholder:"请选择该项目的租方管理员"},on:{focus:function(t){e.getRentManagerList()}},model:{value:e.newProgram.rentManager,callback:function(t){e.$set(e.newProgram,"rentManager",t)},expression:"newProgram.rentManager"}},e._l(e.rentManagerArr,function(e){return r("el-option",{attrs:{label:e.userId+" "+e.userName,value:e.userId+" "+e.userName}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"乙方公司名"}},[r("el-input",{attrs:{placeholder:"请输入公司全称"},model:{value:e.newProgram.companyName,callback:function(t){e.$set(e.newProgram,"companyName",t)},expression:"newProgram.companyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"创建时间",prop:"date"}},[r("el-col",{attrs:{span:11}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择时间"},model:{value:e.newProgram.date,callback:function(t){e.$set(e.newProgram,"date",t)},expression:"newProgram.date"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"备注信息"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.newProgram.desc,callback:function(t){e.$set(e.newProgram,"desc",t)},expression:"newProgram.desc"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit()}}},[e._v("下一步")])],1)],1)],1)},[],!1,null,"42527fc7",null);g.options.__file="index.vue";t.default=g.exports}}]);